---
// Custom Head component that extends Starlight's default Head
import type { Props } from '@astrojs/starlight/props';
import Default from '@astrojs/starlight/components/Head.astro';
---

<Default {...Astro.props}><slot /></Default>

<!-- Sidebar Toggle Button -->
<script is:inline>
  // Immediately restore state to prevent flash
  (function() {
    const isCollapsed = localStorage.getItem('sidebar-collapsed') === 'true';
    if (isCollapsed) {
      document.documentElement.classList.add('sidebar-collapsed');
    }
  })();
</script>

<script is:inline>
  // Add sidebar toggle button after page loads
  document.addEventListener('DOMContentLoaded', () => {
    const html = document.documentElement;
    
    // Create toggle button
    const toggle = document.createElement('button');
    toggle.className = 'sidebar-toggle';
    toggle.setAttribute('aria-label', 'Toggle sidebar');
    toggle.setAttribute('title', 'Toggle sidebar (Ctrl+B)');
    toggle.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>`;
    
    document.body.appendChild(toggle);
    
    // Toggle on click
    toggle.addEventListener('click', () => {
      html.classList.toggle('sidebar-collapsed');
      const collapsed = html.classList.contains('sidebar-collapsed');
      localStorage.setItem('sidebar-collapsed', collapsed.toString());
    });
    
    // Keyboard shortcut: Ctrl+B or Cmd+B
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggle.click();
      }
    });
  });
</script>
