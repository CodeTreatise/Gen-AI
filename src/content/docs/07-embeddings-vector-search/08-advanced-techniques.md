---
title: "Advanced Techniques"
---

# Advanced Techniques

- Multi-vector representations
  - Multiple embeddings per document
  - Different aspects/views captured
  - ColBERT-style token-level representations
  - Late interaction models
  - Aggregation strategies (max, mean)
- Hypothetical Document Embeddings (HyDE)
  - Problem: query-document mismatch
  - Solution: generate hypothetical answer
  - Embed the hypothetical answer
  - Search with answer embedding
  - Improved retrieval for questions
  - When HyDE helps vs hurts
- Query expansion techniques
  - Synonym expansion (traditional)
  - LLM-based query rewriting
  - Multiple query variations
  - Fusion of multi-query results
  - Step-back prompting for queries
- Embedding fine-tuning
  - When to fine-tune (domain-specific)
  - Training data requirements (pairs/triplets)
  - Sentence Transformers fine-tuning
  - Contrastive learning basics
  - Evaluation of fine-tuned models
  - Cost-benefit analysis
- Cross-encoder deep dive
  - How cross-encoders work (joint encoding)
  - Accuracy vs latency trade-offs
  - Two-stage retrieval architecture
  - Popular models: ms-marco-MiniLM, BGE-reranker
  - Training custom cross-encoders
- Clustering embeddings
  - K-means clustering on embeddings
  - Topic discovery from clusters
  - Hierarchical clustering
  - Outlier detection
  - Cluster visualization
  - Use cases: deduplication, categorization
- Parent-child retrieval
  - Small chunks for retrieval precision
  - Return parent context for LLM
  - Implementation patterns
  - Metadata linking strategies
- Recursive retrieval
  - Multi-hop retrieval for complex queries
  - Query decomposition
  - Iterative refinement
  - When to use recursive approaches
- Score Boosting & Formula Queries
  - Inject business logic into vector search
  - Combine similarity score with metadata
  - Time decay: fresher results score higher
  - Geo-distance boosting: closer locations rank up
  - Category weighting: boost titles over snippets
  - Formula syntax (Qdrant): sum, mult, decay functions
  - Example: score + (is_premium * 0.5) + freshness_decay
- Multi-Stage Prefetch Patterns
  - Stage 1: fast retrieval with small vectors
  - Stage 2: rescore with full vectors
  - Qdrant prefetch API for nested queries
  - Combine: byte vectors → full vectors → ColBERT
  - Reduce latency while maintaining quality
  - Cost optimization through staged retrieval
