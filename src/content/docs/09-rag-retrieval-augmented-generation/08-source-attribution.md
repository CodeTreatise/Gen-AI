---
title: "Source Attribution"
---

# Source Attribution

- Citation formats
  - Inline citations [1]
  - Footnote style
  - Academic citations
  - Document links
- Linking to source documents
  - Deep linking to sections
  - Page number references
  - Highlight relevant text
  - One-click verification
- Confidence scoring
  - Retrieval confidence
  - Answer confidence
  - Score display to users
  - Threshold-based warnings
- Inline vs. end citations
  - User preference
  - Use case considerations
  - UI design patterns
  - Accessibility
- Verifiability features
  - Side-by-side comparison
  - Source preview
  - Fact-check workflow
  - User reporting
- Gemini groundingMetadata pattern
  - Structured citation data from grounded responses:
    - `groundingMetadata` object contains three main arrays
    - `webSearchQueries`: array of search queries executed (e.g., "Euro 2024 winner")
    - `groundingChunks`: array of source references with web URI and title
    - `groundingSupports`: array linking response segments to source chunks
    - Each support contains `segment` with startIndex, endIndex, and text excerpt
    - Each support contains `groundingChunkIndices` array pointing to source chunks
  - Segment-based attribution (startIndex, endIndex)
  - Link response text segments to source chunks
  - Build inline clickable citations:
    - Create function `add_citations` that takes response object as parameter
    - Extract text, grounding_supports, and grounding_chunks from response
    - Sort supports by end_index in descending order to avoid index shifting during insertion
    - Iterate through each support and extract the end_index position
    - For each support, build citation links from grounding_chunk_indices
    - Format each citation as markdown link: `[index](uri)`
    - Insert comma-separated citation links at the end_index position in text
    - Return the modified text with inline citations
  - Result: "Spain won Euro 2024[1][2], defeating England...[3][4]"
- OpenAI file attribution pattern
  - Results include file_id, filename, score
  - Format results with source tags:
    - Create function `format_results` that takes results object as parameter
    - Initialize output with opening `<sources>` XML tag
    - Iterate through each result in results.data
    - For each result, add `<result>` tag with file_id attribute
    - Iterate through content parts and wrap each in `<content>` tags
    - Close each result with `</result>` tag
    - Close with `</sources>` tag and return formatted string
    - This XML structure enables LLM to reference sources by file_id
